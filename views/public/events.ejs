<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <title>Events</title>
    <link rel="stylesheet" href="/stylesheets/global.css">
    <link rel="stylesheet" href="/stylesheets/toast.css">
    <link rel="stylesheet" href="/stylesheets/events.css">
</head>
<body>
<div class="nav-bar">
    <div class="nav-buttons">
        <a href="/login" class="nav-button">Anmelden</a>
        <a href="/register" class="nav-button">Registrieren</a>
    </div>
</div>
<div class="hero">
    <h1>Entdecke Veranstaltungen</h1>
    <p>Finde interessante Veranstaltungen und melde dich einfach online an.</p>
    <a href="#all-events" class="cta-button">Jetzt Veranstaltungen entdecken</a>
</div>

<div class="container">
    <div class="section">
        <h2 class="section-title">Nächste Veranstaltungen</h2>
        <p class="section-subtitle">Entdecke unsere kommenden Highlights</p>

        <div class="upcoming-events">
            <!-- Hier würden deine 3 nächsten Events dynamisch eingefügt -->
            <% if (openEvents && openEvents.length > 0) { %>
                <% openEvents.slice(0, 4).forEach(event => { %>
                    <div class="event-card" onclick="window.location='/event/<%= event._id %>'">
                        <div class="event-image">
                            <div class="event-date">
                                <%= new Date(event.startDate).toLocaleDateString('de-DE', {
                                    day: "numeric",
                                    month: "short"
                                }).toUpperCase() %>
                                <div style="font-size: 0.8em; margin-top: 5px;">
                                    <%= new Date(event.startDate).getFullYear() %>
                                </div>
                            </div>
                        </div>
                        <div class="event-content">
                            <h3 class="event-title"><%= event.title %></h3>
                            <div class="event-location">
                                <%= event.location || 'Online' %>
                            </div>
                            <p class="event-description">
                                <%= event.description || 'Keine Beschreibung verfügbar' %>
                            </p>
                            <div class="event-meta">
                                <div class="event-time">
                                    <%= new Date(event.startDate).toLocaleTimeString('de-DE', {
                                        hour: "2-digit",
                                        minute: "2-digit"
                                    }) %> -
                                    <%= new Date(event.endDate).toLocaleTimeString('de-DE', {
                                        hour: "2-digit",
                                        minute: "2-digit"
                                    }) %>
                                </div>
                                <div class="event-registration-count">
                                    <%= event.participants ? event.participants.length : 0 %> angemeldet
                                </div>
                            </div>
                            <a href="/event/<%= event._id %>" class="event-register-btn">Jetzt anmelden</a>
                        </div>
                    </div>
                <% }); %>
            <% } else { %>
                <div style="grid-column: 1 / -1; text-align: center; padding: 60px; color: #7f8c8d;">
                    <h3>Keine kommenden Veranstaltungen</h3>
                    <p>Aktuell stehen keine Veranstaltungen an. Schauen Sie später noch einmal vorbei!</p>
                </div>
            <% } %>
        </div>
    </div>

    <div class="how-it-works">
        <div class="container">
            <h2 class="section-title">So funktioniert's</h2>
            <div class="steps">
                <div class="step">
                    <div class="step-number">1</div>
                    <h3>Entdecken</h3>
                    <p>Schaue Dir unsere aktuellen Veranstaltungen an und finde etwas, das Dich
                        interessiert.</p>
                </div>

                <div class="step">
                    <div class="step-number">2</div>
                    <h3>Anmelden</h3>
                    <p>Melde Dich einfach mit wenigen Klicks zu Deiner gewünschten Veranstaltung an.</p>
                </div>
                <div class="step">
                    <div class="step-number">3</div>
                    <h3>Teilnehmen</h3>
                    <p>Komme zur Veranstaltung und genieße das Event!</p>
                </div>
            </div>
        </div>
    </div>

    <div class="all-events-section" id="all-events">
        <h2 class="section-title">Alle Veranstaltungen</h2>
        <p class="section-subtitle">Übersicht aller anstehenden und vergangenen Events</p>

        <div class="events-grid">
            <!-- Offene Anmeldungen -->
            <% if (openEvents && openEvents.length > 0) { %>
                <% openEvents.forEach(event => { %>
                    <div class="mini-event-card" onclick="window.location='/event/<%= event._id %>'">
                        <div class="mini-event-date">
                            <%= new Date(event.startDate).toLocaleDateString('de-DE', {
                                weekday: "short",
                                day: "numeric",
                                month: "short"
                            }) %>
                        </div>
                        <h4 class="mini-event-title"><%= event.title %></h4>
                        <div class="mini-event-location"><%= event.location || 'Online' %></div>
                        <span class="mini-event-status status-open">Anmeldung offen</span>
                    </div>
                <% }); %>
            <% } %>
            <!-- Anmeldung offen -->
            <% if (openEvents && openEvents.length > 0){ %>
                <% openEvents.forEach(event => { %>
                    <div class="mini-event-card" onclick="window.location='/event/<%= event._id %>'">
                        <div class="mini-event-date">
                            <%= new Date(event.startDate).toLocaleDateString('de-DE', {
                                weekday: "short",
                                day: "numeric",
                                month: "numeric"
                            }) %>
                        </div>
                        <h4 class="mini-event-title"><%= event.title %></h4>
                        <div class="mini-event-location"><%= event.location || 'Online' %></div>
                        <span class="mini-event-status status-closed">Anmeldung geschlossen</span>
                    </div>
                <% }); %>
            <% } %>

            <!-- Anmeldung geschlossen aber noch nicht gestartet -->
            <% if (closedEvents && closedEvents.length > 0) { %>
                <% closedEvents.forEach(event => { %>
                    <div class="mini-event-card" onclick="window.location='/event/<%= event._id %>'">
                        <div class="mini-event-date">
                            <%= new Date(event.startDate).toLocaleDateString('de-DE', {
                                weekday: "short",
                                day: "numeric",
                                month: "numeric"
                            }) %>
                        </div>
                        <h4 class="mini-event-title"><%= event.title %></h4>
                        <div class="mini-event-location"> <%= event.location || 'Online' %></div>
                        <span class="mini-event-status status-closed">Anmeldung geschlossen</span>
                    </div>
                <% }); %>
            <% } %>

            <!-- Vergangene Veranstaltungen -->
            <% if (pastEvents && pastEvents.length > 0) { %>
                <% pastEvents.forEach(event => { %>
                    <div class="mini-event-card">
                        <div class="mini-event-date">
                            <%= new Date(event.startDate).toLocaleDateString('de-DE', {
                                weekday: "short",
                                day: "numeric",
                                month: "numeric"
                            }) %>
                        </div>
                        <h4 class="mini-event-title"><%= event.title %></h4>
                        <div class="mini-event-location"><%= event.location || 'Online' %></div>
                        <span class="mini-event-status status-past">Vergangen</span>
                    </div>
                <% }); %>
            <% } %>
            <% if (!openEvents.length && !closedEvents.length && !pastEvents.length) { %>
                <div class="no-events">
                    <p>Keine Veranstaltungen verfügbar</p>
                </div>
            <% } %>
        </div>
    </div>
</div>

</body>
</html>